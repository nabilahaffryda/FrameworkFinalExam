{"ast":null,"code":"var _jsxFileName = \"D:\\\\react\\\\backend\\\\src\\\\components\\\\Product.js\";\nimport React, { Component } from 'react';\nimport ProductContext from './ProductContext';\nimport firebase from \"firebase\";\nimport firebaseConfig from '../firebase/config';\nimport { storage } from \"firebase\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport class Product extends Component {\n  constructor(props) {\n    super(props);\n\n    this.getDataFromServerAPI = () => {\n      let ref = firebase.database().ref('/');\n      ref.on('value', snapshot => {\n        const state = snapshot.val();\n        this.setState(state);\n      });\n    };\n\n    this.saveDataToServerAPI = () => {\n      firebase.database().ref('/').set(this.state);\n    };\n\n    this.saveImage = () => {\n      if (this.state.imageProduct !== null) {\n        firebase.storage().ref(`/product-image/${this.state.imageProduct.image}`).put(this.state.imageProduct);\n      }\n    };\n\n    this.onImageChange = event => {\n      if (event.target.files && event.target.files[0]) {\n        let filename = event.target.files[0].name;\n        let timestamp = new Date().getTime.toString();\n        let reader = new FileReader();\n\n        reader.onload = e => {\n          this.setState({\n            imageProduct: event.target.files[0],\n            image: e.target.result\n          });\n        };\n\n        reader.readAsDataURL(event.target.files[0]);\n      }\n    };\n\n    this.handleAddProduct = event => {\n      let formInsertProduct = { ...this.state.insertProduct\n      };\n      let timestamp = new Date().getTime();\n      formInsertProduct['pid'] = timestamp;\n      formInsertProduct[event.target.name] = event.target.value;\n      this.setState({\n        insertProduct: formInsertProduct\n      });\n    };\n\n    this.handleSave = event => {\n      let title = this.refs.titleProduct.value;\n      let body = this.refs.bodyProduct.value;\n      let pid = this.refs.pid.value;\n      let price = this.refs.priceProduct.value;\n      let imgfilename = \"\";\n\n      if (this.state.imageProduct != null) {\n        imgfilename = this.state.imageProduct.image;\n      }\n\n      if (pid && image && title & body && price) {\n        const {\n          listProduct\n        } = this.state;\n        const indexProduct = listProduct.findIndex(data => {\n          return data.pid === pid;\n        });\n        listProduct[indexProduct].image = image;\n        listProduct[indexProduct].title = title;\n        listProduct[indexProduct].body = body;\n        listProduct[indexProduct].price = price;\n        this.setState({\n          listProduct\n        });\n      } else if (image && title && body && price) {\n        const pid = new Date().getTime().toString();\n        const {\n          listProduct\n        } = this.state;\n        listProduct.push({\n          pid,\n          image,\n          title,\n          body,\n          price\n        });\n        this.setState({\n          listProduct\n        });\n      }\n\n      this.refs.imageProduct.value = \"\";\n      this.refs.titleProduct.value = \"\";\n      this.refs.bodyProduct.value = \"\";\n      this.refs.priceProduct.value = \"\";\n      this.refs.pid.value = \"\";\n    };\n\n    this.handleDeleteProduct = idProduct => {\n      const {\n        listProduct\n      } = this.state;\n      const newState = listProduct.filter(data => {\n        return data.pid !== idProduct;\n      });\n      this.setState({\n        listProduct: newState\n      });\n    };\n\n    firebase.initializeApp(firebaseConfig);\n    this.state = {\n      listProduct: [],\n      image: null\n    };\n  }\n\n  componentDidMount() {\n    this.getDataFromServerAPI();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevState !== this.state) {\n      this.saveDataToServerAPI();\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"content-wrapper\",\n          className: \"col-xs-12 col-sm-12 col-md-12 col-lg-12 onecol\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"main\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              id: \"content\",\n              className: \"page-content\",\n              children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 117,\n                columnNumber: 72\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 117,\n                columnNumber: 81\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"add-form text-center \",\n                children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n                  className: \"text-center title-page\",\n                  children: \"Add New Product\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 119,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n                  className: \"js-addproduct-form border-bottom\",\n                  children: [/*#__PURE__*/_jsxDEV(\"center\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"col-sm-6\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"form-group\",\n                        children: /*#__PURE__*/_jsxDEV(\"div\", {\n                          children: /*#__PURE__*/_jsxDEV(\"input\", {\n                            className: \"form-control\",\n                            ref: \"titleProduct\",\n                            id: \"title\",\n                            name: \"title\",\n                            onChange: this.handleAddProduct,\n                            type: \"text\",\n                            placeholder: \"Name\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 125,\n                            columnNumber: 49\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 124,\n                          columnNumber: 45\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 123,\n                        columnNumber: 45\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"form-group\",\n                        children: /*#__PURE__*/_jsxDEV(\"div\", {\n                          children: /*#__PURE__*/_jsxDEV(\"input\", {\n                            className: \"form-control\",\n                            ref: \"bodyProduct\",\n                            id: \"body\",\n                            name: \"body\",\n                            onChange: this.handleAddProduct,\n                            type: \"text\",\n                            placeholder: \"Description\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 130,\n                            columnNumber: 49\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 129,\n                          columnNumber: 45\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 128,\n                        columnNumber: 45\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"form-group\",\n                        children: /*#__PURE__*/_jsxDEV(\"div\", {\n                          children: /*#__PURE__*/_jsxDEV(\"input\", {\n                            className: \"form-control\",\n                            ref: \"priceProduct\",\n                            id: \"price\",\n                            name: \"price\",\n                            onChange: this.handleAddProduct,\n                            type: \"number\",\n                            placeholder: \"Price\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 135,\n                            columnNumber: 49\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 134,\n                          columnNumber: 45\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 133,\n                        columnNumber: 45\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"form-group\",\n                        children: /*#__PURE__*/_jsxDEV(\"div\", {\n                          children: /*#__PURE__*/_jsxDEV(\"input\", {\n                            className: \"form-control\",\n                            ref: \"imageProduct\",\n                            id: \"image\",\n                            name: \"image\",\n                            type: \"file\",\n                            onChange: this.onImageChange,\n                            placeholder: \"Picture\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 140,\n                            columnNumber: 49\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 139,\n                          columnNumber: 45\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 138,\n                        columnNumber: 45\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 122,\n                      columnNumber: 41\n                    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"hidden\",\n                      name: \"pid\",\n                      ref: \"pid\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 144,\n                      columnNumber: 41\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 121,\n                    columnNumber: 37\n                  }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 145,\n                    columnNumber: 46\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"clearfix\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      children: /*#__PURE__*/_jsxDEV(\"button\", {\n                        className: \"btn btn-primary\",\n                        onClick: this.handleSave,\n                        type: \"submit\",\n                        children: \"Add Product\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 148,\n                        columnNumber: 41\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 147,\n                      columnNumber: 41\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 146,\n                    columnNumber: 37\n                  }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 152,\n                    columnNumber: 43\n                  }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 152,\n                    columnNumber: 52\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 120,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 153,\n                  columnNumber: 44\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 118,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"center\", {\n                children: /*#__PURE__*/_jsxDEV(\"h2\", {\n                  className: \"text-center title-page\",\n                  children: \"Features Products\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 155,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 155,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"container\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"tab-content product-items\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      id: \"grid\",\n                      className: \"related tab-pane fade in active show\",\n                      children: /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"row\",\n                        children: this.state.listProduct.map(product => {\n                          return /*#__PURE__*/_jsxDEV(ProductContext, {\n                            image: product.image,\n                            title: product.title,\n                            body: product.body,\n                            price: product.price,\n                            idProduct: product.pid,\n                            deleteProduct: pid => this.handleDeleteProduct(pid)\n                          }, product.pid, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 163,\n                            columnNumber: 68\n                          }, this);\n                        })\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 160,\n                        columnNumber: 45\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 159,\n                      columnNumber: 41\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 158,\n                    columnNumber: 37\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 157,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 156,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 13\n    }, this);\n  }\n\n}\nexport default Product;","map":{"version":3,"sources":["D:/react/backend/src/components/Product.js"],"names":["React","Component","ProductContext","firebase","firebaseConfig","storage","Product","constructor","props","getDataFromServerAPI","ref","database","on","snapshot","state","val","setState","saveDataToServerAPI","set","saveImage","imageProduct","image","put","onImageChange","event","target","files","filename","name","timestamp","Date","getTime","toString","reader","FileReader","onload","e","result","readAsDataURL","handleAddProduct","formInsertProduct","insertProduct","value","handleSave","title","refs","titleProduct","body","bodyProduct","pid","price","priceProduct","imgfilename","listProduct","indexProduct","findIndex","data","push","handleDeleteProduct","idProduct","newState","filter","initializeApp","componentDidMount","componentDidUpdate","prevProps","prevState","render","map","product"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport ProductContext from './ProductContext';\r\nimport firebase from \"firebase\";\r\nimport firebaseConfig from '../firebase/config';\r\nimport {storage} from \"firebase\";\r\n\r\nexport class Product extends Component {\r\n    constructor(props){\r\n        super(props);\r\n        firebase.initializeApp(firebaseConfig);\r\n        this.state = {\r\n            listProduct: [],\r\n            image: null,\r\n            \r\n        };\r\n    }\r\n    getDataFromServerAPI = () => {\r\n        let ref = firebase.database().ref('/')\r\n        ref.on('value', snapshot => {\r\n            const state = snapshot.val()\r\n            this.setState(state)\r\n        })\r\n    }\r\n    saveDataToServerAPI = () => {\r\n        firebase.database()\r\n            .ref('/')\r\n            .set(this.state)\r\n    }\r\n    componentDidMount(){\r\n        this.getDataFromServerAPI();\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState){\r\n        if(prevState !== this.state){\r\n            this.saveDataToServerAPI();\r\n        }\r\n    }\r\n    saveImage = () => {\r\n        if(this.state.imageProduct !== null){\r\n            firebase\r\n                .storage()\r\n                .ref(`/product-image/${this.state.imageProduct.image}`)\r\n                .put(this.state.imageProduct);\r\n        }\r\n    }\r\n\r\n    onImageChange = (event) => {\r\n        if(event.target.files && event.target.files[0]){\r\n            let filename = event.target.files[0].name;\r\n            let timestamp = new Date().getTime.toString();\r\n            let reader = new FileReader();\r\n            reader.onload = (e) => {\r\n                this.setState({\r\n                    imageProduct : event.target.files[0],\r\n                    image : e.target.result,\r\n                    \r\n                });\r\n            };\r\n            reader.readAsDataURL(event.target.files[0]);\r\n        }\r\n    }\r\n\r\n    handleAddProduct = (event) => {\r\n        let formInsertProduct = { ...this.state.insertProduct};\r\n        let timestamp = new Date().getTime();\r\n        formInsertProduct['pid'] = timestamp;\r\n        formInsertProduct[event.target.name] = event.target.value;\r\n        this.setState({insertProduct: formInsertProduct,});\r\n    }\r\n    \r\n    handleSave = (event) => {\r\n        let title = this.refs.titleProduct.value;\r\n        let body = this.refs.bodyProduct.value;\r\n        let pid = this.refs.pid.value;\r\n        let price = this.refs.priceProduct.value;\r\n        let imgfilename = \"\";\r\n        if(this.state.imageProduct != null){\r\n            imgfilename = this.state.imageProduct.image;\r\n        }\r\n\r\n        if (pid && image && title & body && price){\r\n            const{listProduct} = this.state;\r\n            const indexProduct = listProduct.findIndex(data => {\r\n                return data.pid === pid;\r\n            });\r\n            listProduct[indexProduct].image = image;\r\n            listProduct[indexProduct].title = title;\r\n            listProduct[indexProduct].body = body;\r\n            listProduct[indexProduct].price = price;\r\n            this.setState({listProduct});\r\n        }else if(image && title && body && price){\r\n            const pid = new Date().getTime().toString();\r\n            const {listProduct} = this.state;\r\n            listProduct.push({pid, image, title, body, price});\r\n            this.setState({listProduct});\r\n        }\r\n        this.refs.imageProduct.value = \"\";\r\n        this.refs.titleProduct.value = \"\";\r\n        this.refs.bodyProduct.value = \"\";\r\n        this.refs.priceProduct.value = \"\";\r\n        this.refs.pid.value = \"\";\r\n    }\r\n\r\n    handleDeleteProduct = (idProduct) => {\r\n        const {listProduct} = this.state;\r\n        const newState = listProduct.filter(data => {\r\n            return data.pid !== idProduct;\r\n        });\r\n        this.setState({listProduct: newState});\r\n    }\r\n    render(){\r\n        return(\r\n            <div className=\"container\">\r\n                <div className=\"row\">\r\n                    <div id=\"content-wrapper\" className=\"col-xs-12 col-sm-12 col-md-12 col-lg-12 onecol\">\r\n                        <div id=\"main\">\r\n                            <div id=\"content\" className=\"page-content\"><br></br><br></br>\r\n                                <div className=\"add-form text-center \">\r\n                                    <h1 className=\"text-center title-page\">Add New Product</h1>\r\n                                    <form className=\"js-addproduct-form border-bottom\">\r\n                                    <center>\r\n                                        <div className=\"col-sm-6\">\r\n                                            <div className=\"form-group\">\r\n                                            <div>\r\n                                                <input className=\"form-control\" ref=\"titleProduct\" id=\"title\" name=\"title\" onChange={this.handleAddProduct} type=\"text\" placeholder=\"Name\" />\r\n                                            </div>\r\n                                            </div>\r\n                                            <div className=\"form-group\">\r\n                                            <div>\r\n                                                <input className=\"form-control\" ref=\"bodyProduct\" id=\"body\" name=\"body\" onChange={this.handleAddProduct} type=\"text\" placeholder=\"Description\" />\r\n                                            </div>\r\n                                            </div>\r\n                                            <div className=\"form-group\">\r\n                                            <div>\r\n                                                <input className=\"form-control\" ref=\"priceProduct\" id=\"price\" name=\"price\" onChange={this.handleAddProduct} type=\"number\" placeholder=\"Price\" />\r\n                                            </div>\r\n                                            </div>\r\n                                            <div className=\"form-group\">\r\n                                            <div>\r\n                                                <input className=\"form-control\" ref=\"imageProduct\" id=\"image\" name=\"image\" type=\"file\" onChange={this.onImageChange} placeholder=\"Picture\" />\r\n                                            </div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <input type=\"hidden\" name=\"pid\" ref=\"pid\"/>\r\n                                    </center><br></br>\r\n                                    <div className=\"clearfix\">\r\n                                        <div>\r\n                                        <button className=\"btn btn-primary\"  onClick={this.handleSave} type=\"submit\">\r\n                                            Add Product\r\n                                        </button>\r\n                                        </div>\r\n                                    </div><br></br><br></br>\r\n                                    </form><br></br>\r\n                                </div>\r\n                                <center><h2 className=\"text-center title-page\">Features Products</h2></center>\r\n                                <section>\r\n                                    <div className=\"container\">\r\n                                    <div className=\"tab-content product-items\">\r\n                                        <div id=\"grid\" className=\"related tab-pane fade in active show\">\r\n                                            <div className=\"row\">\r\n                                                {\r\n                                                        this.state.listProduct.map(product => {\r\n                                                            return <ProductContext\r\n                                                            key = {product.pid}\r\n                                                            image={product.image}\r\n                                                            title={product.title}\r\n                                                            body={product.body}\r\n                                                            price={product.price}\r\n                                                            idProduct={product.pid}\r\n                                                            deleteProduct={(pid) => this.handleDeleteProduct(pid)}/>\r\n                                                        })\r\n                                                    }\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </section>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n} export default Product"]},"metadata":{},"sourceType":"module"}